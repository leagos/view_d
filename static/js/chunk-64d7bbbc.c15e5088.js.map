{"version":3,"sources":["webpack:///./src/views/list/pool.vue","webpack:///./src/views/list/pool.vue?2c79","webpack:///./src/views/list/pool.vue?4b54"],"names":["class","left-arrow","title","$t","$goBack","records","item","dayNum","amount","isGive","Number","getDividends","setup","store","data","address","state","accounts","web3","provider","BsnContract","BusdContract","freezeContract","windTokenContract","BsnDataContract","initContract","eth","Contract","BSNAbi","config","BsnAddress","BusdAddress","BSNDataAbi","BsnDataAddress","windToken","initData","getList","arr","methods","getCurDayNum","call","decimals","i","from","curIncome","isDividend","params","dividedBy","Math","pow","toFixed","slice","push","day","getGasPrice","gasPrice","receiveDividends","send","val","refData","__exports__","render"],"mappings":"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","file":"static/js/chunk-64d7bbbc.c15e5088.js","sourcesContent":["<template>\r\n  <div class=\"container bg-container\">\r\n    <van-nav-bar\r\n      left-arrow\r\n      :title=\"$t('list.矿池分红记录')\"\r\n      @click-left=\"$goBack\" />\r\n    <div class=\"list\">\r\n      <div class=\"item flex-middle\"  v-for=\"item in records\">\r\n        <div class=\"flex-item\">\r\n          <div class=\"flex row\">\r\n            <div class=\"label\">{{$t('list.结算周期')}}：</div>\r\n            <div class=\"flex-item cont\">{{item.dayNum}}</div>\r\n          </div>\r\n          <div class=\"flex row\">\r\n            <div class=\"label\">{{$t('list.分红数量')}}：</div>\r\n            <div class=\"flex-item cont\">{{item.amount}} BNX Token</div>\r\n          </div>\r\n        </div>\r\n        <div class=\"btn\" v-if=\"!item.isGive && Number(item.amount)\" @click=\"getDividends(item.dayNum)\">{{$t('list.领取')}}</div>\r\n        <div class=\"num c-2FBBA1\" v-else>{{$t('list.已领取')}}</div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n// import { Toast } from 'vant';\r\nimport { reactive, toRefs, computed, watch} from \"vue\";\r\nimport BSNAbi from \"@/utils/BSNAbi\";\r\nimport tokenAbi from \"@/utils/abi\";\r\nimport config from \"@/utils/config\";\r\nimport {useStore} from \"vuex\";\r\nimport Bignumber from \"bignumber.js\";\r\nimport BSNDataAbi from \"@/utils/BSNDataAbi\";\r\nexport default {\r\n  setup () {\r\n    const store = useStore()\r\n    const data = reactive({\r\n      records: [],\r\n      address: computed(() => store.state.accounts[0]),\r\n      web3: computed(() => store.state.provider),\r\n      BsnContract: null,\r\n      BusdContract: null,\r\n      freezeContract: null,\r\n      windTokenContract: null,\r\n      BsnDataContract: null,\r\n      initContract: () => {\r\n        data.BsnContract = new data.web3.eth.Contract(BSNAbi, config.BsnAddress)\r\n        data.BusdContract = new data.web3.eth.Contract(tokenAbi, config.BusdAddress)\r\n        data.BsnDataContract = new data.web3.eth.Contract(BSNDataAbi, config.BsnDataAddress)\r\n        data.windTokenContract = new data.web3.eth.Contract(tokenAbi, config.windToken)\r\n        data.initData()\r\n      },\r\n      initData: () => {\r\n        data.getList()\r\n      },\r\n      getList: async () => {\r\n      \r\n        let arr = [];\r\n        let dayNum = await data.BsnDataContract.methods.getCurDayNum().call()\r\n        let decimals = await data.windTokenContract.methods.decimals().call();\r\n        for(let i = 1; i < dayNum; i++) {\r\n          let curIncome = await data.BsnContract.methods.getDividends(i).call({from: data.address})\r\n          console.log(curIncome)\r\n          let isGive = await data.BsnDataContract.methods.isDividend(data.address, i).call({from: data.address})\r\n          let params = {\r\n            amount: new Bignumber(curIncome).dividedBy(Math.pow(10, decimals)).toFixed(5).slice(0,-1),\r\n            isGive: isGive,\r\n            dayNum: i\r\n          }\r\n          arr.push(params)\r\n        }\r\n        data.records = arr;\r\n        console.log(arr)\r\n      },\r\n      getDividends: async (day) => {\r\n         let gasPrice = await data.web3.eth.getGasPrice()\r\n         await data.BsnContract.methods.receiveDividends(day).send({from: data.address, gasPrice: gasPrice})\r\n         data.getList()\r\n      }\r\n    })\r\n    if (data.address) {\r\n      data.initContract()\r\n    }\r\n     watch(() => data.address, (val) => {\r\n      if (val) {\r\n        data.initContract()\r\n      }\r\n    })\r\n    const refData = toRefs(data);\r\n    return {\r\n      ...refData\r\n    };\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.list {\r\n  margin: 15px;\r\n  border-radius: 25px;\r\n  background: #1A1C25;\r\n  padding: 20px 15px;\r\n  .item {\r\n    background: #22242B;\r\n    border-radius: 13px;\r\n    padding: 13px 12px;\r\n    color: #999999;\r\n    .row + .row {\r\n      margin: 6px 0 0;\r\n    }\r\n    .cont {\r\n      word-break: break-all;\r\n    }\r\n    .num {\r\n      font-size: 15px;\r\n      font-weight: bold;\r\n      margin-left: 15px;\r\n    }\r\n    .btn {\r\n      padding: 0 17px;\r\n      color: #14151A;\r\n      line-height: 23px;\r\n      border-radius: 12px;\r\n      font-size: 13px;\r\n      background: #FBC509;\r\n      margin-left: 15px;\r\n    }\r\n  }\r\n  .item + .item {\r\n    margin-top: 15px;\r\n  }\r\n}\r\n</style>\r\n","import { render } from \"./pool.vue?vue&type=template&id=a228e9c8&scoped=true\"\nimport script from \"./pool.vue?vue&type=script&lang=js\"\nexport * from \"./pool.vue?vue&type=script&lang=js\"\n\nimport \"./pool.vue?vue&type=style&index=0&id=a228e9c8&lang=less&scoped=true\"\n\nimport exportComponent from \"D:\\\\contract\\\\frontend\\\\node_modules\\\\@vue\\\\cli-service\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-a228e9c8\"]])\n\nexport default __exports__","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./pool.vue?vue&type=style&index=0&id=a228e9c8&lang=less&scoped=true\""],"sourceRoot":""}